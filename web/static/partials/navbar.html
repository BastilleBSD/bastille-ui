{{ define "navbar" }}
<nav class="navbar">

  <div class="navbar-left">
    <button class="navbar-left-hamburger-menu">
	  <span>>></span>
	</button>
  </div>

  <div class="navbar-center">
    <a href="/">
      <img src="/static/bastille-logo.png" alt="Bastille Logo" class="logo">
      <span class="title">Bastion</span>
    </a>
    <div class="navbar-node-selector">
      <form method="POST" action="/api/v1/node/select">
        <select name="node" onchange="this.form.submit()">
          <option disabled {{ if not .ActiveNode }}selected{{ end }}>Select Node</option>
          {{ range .Nodes }}
          <option value="{{ .Name }}" {{ if and $.ActiveNode (eq .Name $.ActiveNode.Name) }}selected{{ end }}>
            {{ .Name }}
          </option>
          {{ end }}
        </select>
      </form>
    </div>
  </div>
  
	<button class="navbar-right-hamburger-menu" aria-label="Menu">
      <span></span>
      <span></span>
      <span></span>
    </button>

  <div class="navbar-right">
	  <a href="/nodes" class="button">Nodes</a>
      <a href="https://bastille.readthedocs.io" class="button" target="_blank">Docs</a>
      <a href="/settings" class="button">Settings âš™</a>
      <a href="/logout" class="button">Logout</a>
  </div>
</nav>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const sideBtn = document.querySelector('.navbar-left-hamburger-menu');
    const sidebar = document.querySelector('.sidebar');
    const rightMenuBtn = document.querySelector('.navbar-right-hamburger-menu');
    const rightMenu = document.querySelector('.navbar-right');

    // 1. Sidebar Toggle (Left)
    if (sideBtn && sidebar) {
        sideBtn.addEventListener('click', function(e) {
            e.stopPropagation(); // Prevents the "Click Outside" logic from firing immediately
            sidebar.classList.toggle('open');
            sideBtn.classList.toggle('active');
        });
    }

    // 2. Right Navbar Toggle (Mobile)
    if (rightMenuBtn && rightMenu) {
        rightMenuBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            rightMenu.classList.toggle('open');
        });
    }

    // 3. Click Outside to Close (Mobile Only)
    document.addEventListener('click', function(event) {
        const isMobile = window.innerWidth <= 720;
        if (!isMobile) return;

        // Close sidebar if clicking outside
        if (sidebar && sidebar.classList.contains('open')) {
            if (!sidebar.contains(event.target) && !sideBtn.contains(event.target)) {
                sidebar.classList.remove('open');
                sideBtn.classList.remove('active');
            }
        }

        // Close right menu if clicking outside
        if (rightMenu && rightMenu.classList.contains('open')) {
            if (!rightMenu.contains(event.target) && !rightMenuBtn.contains(event.target)) {
                rightMenu.classList.remove('open');
            }
        }
    });
});
</script>
{{end}}
